<html>

<head>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.3/dist/leaflet.css" integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
    crossorigin="" />

<script src="https://unpkg.com/leaflet@1.3.3/dist/leaflet.js" integrity="sha512-tAGcCfR4Sc5ZP5ZoVz0quoZDYX5aCtEm/eu1KhSLj2c9eFrylXZknQYmxUssFaVJKvvc0dJQixhGjG2yXWiV9Q=="
    crossorigin="">
     
</script>
<script src="Simplified_County_Boundaries.js"></script>   
</head>

<body>
  <div id="bagsDiv"></div>
  <div id="teamsDiv"></div>
  <div id="profilesDiv"></div>
  
  <script src="https://www.gstatic.com/firebasejs/5.3.0/firebase.js"></script>
  <scipt src="countyMap.html"></scipt>
  <script src="https://unpkg.com/@mapbox/leaflet-pip@latest/leaflet-pip.js"></script>
  <script>
    //these are the variables that point to useful numbers
    let totalBagsDropped;
    let totalTeams;
    let totalProfiles;

    // Initialize Firebase
    var config = {
      apiKey: "AIzaSyAjwSCpOvLPgYcFr26V3gmfwJlGb-VtWAs",
      authDomain: "greenupvermont-de02b.firebaseapp.com",
      databaseURL: "https://greenupvermont-de02b.firebaseio.com",
      projectId: "greenupvermont-de02b",
      storageBucket: "greenupvermont-de02b.appspot.com",
      messagingSenderId: "439621369113"
    };
    const email = "WillyNillyLoman@gmail.com"
    const password = "burlingtonCA"

    firebase.initializeApp(config);
    var database = firebase.database();

    // var teams = firebase.database().ref('teams');

    firebase.auth().signInWithEmailAndPassword(email, password).catch(function (error) {
      // Handle Errors here.
      var errorCode = error.code;
      var errorMessage = error.message;
      // ...
    });
    let trashDropsObject;
    let bagCountArray = []

    function getTotalBags() {
      var trashDrops = firebase
        .database()
        .ref('trashDrops/')
        .on('value', function (snapshot) {
          let bagCountArray = []
          trashDropsObject = snapshot.val()
          for (var key in trashDropsObject) {
            bagCountArray.push(trashDropsObject[key].bagCount)
          }
          totalBagsDropped = bagCountArray.reduce(function (total, currentValue) {
            return total + currentValue;
          }, 0);
          document.getElementById("bagsDiv").textContent = "Total bags dropped in VT: " + totalBagsDropped

        })
    }

    function getTotalProfiles() {
      var teams = firebase
        .database()
        .ref('profiles/')
        .on('value', function (snapshot) {
          let profilesCountArray = []
          profilesCountObject = snapshot.val()
          for (var key in profilesCountObject) {
            profilesCountArray.push(profilesCountObject[key])
          }
          totalProfiles = profilesCountArray.length
          document.getElementById("profilesDiv").textContent = "Total profiles in VT: " + totalProfiles

        })
    }

    function getTotalTeams(){
      var profiles = firebase
        .database()
        .ref('teams/')
        .on('value', function (snapshot) {
          let teamsCountArray = []
          teamCountObject = snapshot.val()
          for (var key in teamCountObject) {
            teamsCountArray.push(teamCountObject[key])
          }
          totalTeams = teamsCountArray.length
          document.getElementById("teamsDiv").textContent = "Total teams in VT: " + totalTeams

        })
    }

    function bagsInChit(){
      let countyBoundaries = L.geoJSON(countyPolygons);
      var results = leafletPip.pointInLayer([-72.6034, 44.0423], countyBoundaries, true)
      console.log(results)
    }

   
    getTotalBags();
    getTotalTeams();
    getTotalProfiles();



  </script>
</body>

</html>